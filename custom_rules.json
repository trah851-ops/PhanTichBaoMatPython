[
  {
    "id": "P001",
    "type": "Logic",
    "message": "Có vòng lặp for nhưng không có nội dung thực thi.",
    "pattern": "for\\s+\\w+\\s+in\\s+.*:\\s*\\n\\s*(pass|#.*)",
    "severity": "medium"
  },
  {
    "id": "P002",
    "type": "Logic",
    "message": "Gọi main() nhưng không có guard if __name__ == '__main__'.",
    "pattern": "(?s)(?<!__name__\\s*==\\s*['\"]__main__['\"]).*\\bmain\\s*\\(",
    "severity": "low"
  },
  {
    "id": "P003",
    "type": "Logic",
    "message": "Biến bị gán liên tiếp — có thể ghi đè không mong muốn.",
    "pattern": "\\b(\\w+)\\s*=.*\\n\\s*\\1\\s*=",
    "severity": "medium"
  },
  {
    "id": "P004",
    "type": "Security",
    "message": "open() không dùng trong context manager (with).",
    "pattern": "(?<!with\\s)open\\s*\\([^)]*\\)",
    "severity": "medium"
  },
  {
    "id": "P005",
    "type": "Security",
    "message": "requests.* không có timeout — dễ gây treo.",
    "pattern": "requests\\.(get|post|put|delete|patch)\\([^)]*(?<!timeout\\s*=)",
    "severity": "medium"
  },
  {
    "id": "P006",
    "type": "Logic",
    "message": "Hàm có nhiều return — xem xét hợp nhất logic.",
    "pattern": "(?s)return\\b[\\s\\S]*?return\\b",
    "severity": "low"
  },
  {
    "id": "P007",
    "type": "Style",
    "message": "Phát hiện print() — debug code.",
    "pattern": "\\bprint\\s*\\(",
    "severity": "low"
  },
  {
    "id": "P008",
    "type": "Style",
    "message": "Phát hiện TODO hoặc FIXME.",
    "pattern": "#\\s*(TODO|FIXME)",
    "severity": "low"
  },
  {
    "id": "P009",
    "type": "Security",
    "message": "Truy cập biến môi trường nhạy cảm.",
    "pattern": "os\\.environ\\[['\"]?(.*SECRET|TOKEN|PASS|KEY)['\"]?\\]",
    "severity": "medium"
  },
  {
    "id": "P010",
    "type": "Logic",
    "message": "Khối try không có except hoặc finally.",
    "pattern": "try\\s*:\\s*\\n\\s*(?!except|finally)",
    "severity": "high"
  },

  

  {
    "id": "S001",
    "type": "Security",
    "message": "Possible SQL injection detected (raw query string).",
    "pattern": "(SELECT|INSERT|UPDATE|DELETE).*['\"].*['\"]",
    "severity": "high"
  },
  {
    "id": "S002",
    "type": "Security",
    "message": "pickle.load() with untrusted input can lead to RCE.",
    "pattern": "pickle\\.load\\(",
    "severity": "high"
  },
  {
    "id": "S003",
    "type": "Security",
    "message": "Weak hashing algorithm detected (MD5/SHA1).",
    "pattern": "hashlib\\.(md5|sha1)\\(",
    "severity": "high"
  },
  {
    "id": "S004",
    "type": "Security",
    "message": "Possible hardcoded password.",
    "pattern": "(password|passwd|pwd)\\s*=\\s*['\"].+['\"]",
    "severity": "high"
  },
  {
    "id": "S005",
    "type": "Security",
    "message": "AWS secret key detected.",
    "pattern": "AKIA[0-9A-Z]{16}",
    "severity": "high"
  },
  {
    "id": "S006",
    "type": "Security",
    "message": "random module is not cryptographically secure. Use secrets module.",
    "pattern": "\\brandom\\.",
    "severity": "medium"
  },
  {
    "id": "S007",
    "type": "Security",
    "message": "Unsafe yaml.load() detected. Use safe_load().",
    "pattern": "yaml\\.load\\(",
    "severity": "medium"
  },
  {
    "id": "S008",
    "type": "Security",
    "message": "os.popen() is dangerous when handling user input.",
    "pattern": "os\\.popen\\(",
    "severity": "high"
  },
  {
    "id": "S009",
    "type": "Security",
    "message": "subprocess call without safe args and no shell=False explicit.",
    "pattern": "subprocess\\.(run|Popen|call)\\(",
    "severity": "medium"
  },

  

  {
    "id": "L001",
    "type": "Maintainability",
    "message": "Function too long (>50 lines). Consider refactoring.",
    "pattern": "def\\s+\\w+\\s*\\([^)]*\\):([\\s\\S]{300,})",
    "severity": "low"
  },
  {
    "id": "L002",
    "type": "Maintainability",
    "message": "Deeply nested conditional logic (>3 levels).",
    "pattern": "if\\s+.*\\n\\s+if\\s+.*\\n\\s+if",
    "severity": "medium"
  },
  {
    "id": "L003",
    "type": "Logic",
    "message": "Variable reused in two different scopes.",
    "pattern": "\\bfor\\s+(\\w+)\\s+in\\b[\\s\\S]*\\n\\s*\\1\\s*=",
    "severity": "medium"
  },

  

  {
    "id": "P101",
    "type": "Performance",
    "message": "String concatenation inside loop. Use join() instead.",
    "pattern": "for\\s+.*:\\s*\\n\\s*[^#]*\\+\\=",
    "severity": "medium"
  },
  {
    "id": "P102",
    "type": "Performance",
    "message": "Recompiled regex inside loop.",
    "pattern": "for\\s+.*:\\s*\\n[^\\n]*re\\.compile",
    "severity": "medium"
  },
  {
    "id": "P103",
    "type": "Performance",
    "message": "Repeated list append inside loop.",
    "pattern": "for\\s+.*:\\s*\\n[^\\n]*append",
    "severity": "low"
  },



  {
    "id": "A001",
    "type": "Style",
    "message": "Bare except detected — should catch specific exception.",
    "pattern": "except\\s*:",
    "severity": "medium"
  },
  {
    "id": "A002",
    "type": "Style",
    "message": "Wildcard import detected. Avoid using *.",
    "pattern": "from\\s+\\w+\\s+import\\s+\\*",
    "severity": "low"
  },
  {
    "id": "A003",
    "type": "Logic",
    "message": "Mutable default parameter detected.",
    "pattern": "def\\s+\\w+\\s*\\([^)]*(\\[|\\{|\\})[^)]*\\)",
    "severity": "high"
  },
  {
    "id": "A004",
    "type": "Debug",
    "message": "Debugger statements present (pdb/ipdb).",
    "pattern": "import\\s+pdb|pdb\\.set_trace",
    "severity": "low"
  },

  

  {
    "id": "S010",
    "type": "Security",
    "message": "marshal is unsafe for untrusted data.",
    "pattern": "import\\s+marshal",
    "severity": "high"
  },
  {
    "id": "S011",
    "type": "Security",
    "message": "dill is unsafe and can deserialize dangerous objects.",
    "pattern": "import\\s+dill",
    "severity": "high"
  },

  

  {
    "id": "C001",
    "type": "Threading",
    "message": "Thread.start() used without join().",
    "pattern": "Thread\\([^)]*\\)\\s*\\.start",
    "severity": "medium"
  },
  {
    "id": "C002",
    "type": "Async",
    "message": "Async function called without await.",
    "pattern": "async\\s+def\\s+(\\w+)[\\s\\S]*?\\1\\(",
    "severity": "medium"
  }
]
